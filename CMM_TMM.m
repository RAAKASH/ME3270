 %% Data of CMM
 X = [300.9118;303.2366;305.6026;301.3408;303.6750;...
     306.0347;301.2681;303.6355;305.9935;301.7059;...
     304.0722;306.4235];
 Y = -[218.9807;218.9518;218.9252;223.6789;223.6297;...
      223.5774;219.4823;219.4347;219.3993;223.1576;...
      223.1101;223.0722];
  Theta = zeros(4,2);
  A = 0;
 %%  straight lines
 for i = 1:4
  A(1:3,1) = X((1+(i-1)*3):(3*i)) ;
  A(1:3,2) = 1;
  b = Y((1+(i-1)*3):(3*i));
  Theta(i,:) =((A'*A)\(A'*b))';
 end
 
 %% Helix Angles
 alpha = pi+ atan((Y(7)-Y(10))/(X(7)-X(10)));
 beta  =  atan(Theta(3,1));
 Helix_angle = (alpha - beta -pi/2)*180/pi; 
 
 %% Thread angle data
 X1 =  [302.1481;302.2209;302.2946;302.5818;302.6323;302.6794];
 Y1 = -[219.3643;219.2195;219.0436;219.0731;219.1592;219.2666];
  Theta1= zeros(2,2);
  A = 0;
  for i = 1:2
  A(1:3,1) = X1((1+(i-1)*3):(3*i)) ;
  A(1:3,2) = 1;
  b = Y1((1+(i-1)*3):(3*i));
  Theta1(i,:) =((A'*A)\(A'*b))';
  end
 
  Thread_angle = -(- pi + atan(Theta1(1,1)) - atan(Theta1(2,1)))*180/pi;
  
  
  %%  TMM DATA
  MSR = [36,41;40,41;45,41.5;44.5,...
         40.5;41.5,40.5;38.5,40.5;34,32;36,32;31.5,31.5;32,32.5;35,32.5;39.5,33];
  CSR = [2,21;6,32;2,5;58,15;57,95;60,80;43,44;49,31;40,90;83,74;95,99;95,29];
  VSR = [5,1;2,4;5,1;3,1;1,1;1,1;0,1;4,2;3,3;2,3;3,5;4,3];
  
  Reading = MSR + CSR*.005 + VSR*.001 ;
  
   %%  straight lines
   A = 0;
 for i = 1:4
  A(1:3,1) = Reading((1+(i-1)*3):(3*i),1) ;
  A(1:3,2) = 1;
  b = Reading((1+(i-1)*3):(3*i),2);
  Theta3(i,:) =((A'*A)\(A'*b))';
 end
  
 %% Diameters ,Pitch 
norm(Reading(1,:)-Reading(2,:)) % = 3*pitch
zeta = Reading(6,:)-Reading(12,:); 
atan(zeta(2)/zeta(1))*180/pi % For helix angle